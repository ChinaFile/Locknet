+++
title = "Blocking Circumvention Technologies"
weight = 3
toc = true
+++

China’s censorship system not only targets “dangerous” content, but also targets users’ attempts to evade the system itself. After all, Beijing spends a lot of money and effort to curate the domestic information environment and keep “dangerous” information outside the country’s digital borders. There would be no point to such an undertaking if it were trivially easy to sidestep the censors. 

Since about 2010, China has put a special premium on hunting down and blocking information about and access to censorship circumvention tools. The censors are engaged in a seemingly endless arms race with circumvention tool developers, who try to create countermeasures after each new block. (It is worth mentioning that Chinese authorities do not block every single possible circumvention tool. Bowing to economic necessity, the government maintains a list of [approved technologies](https://www.wsj.com/articles/chinas-vpn-crackdown-may-aid-government-surveillance-1516189155) that allow foreign businesses and others to circumvent the censorship system in order to send secure emails or visit blocked websites. These approved circumvention tools also likely allow the government to surveil communications sent within them.) 

For average citizens hoping to evade censorship, the barriers to entry have gotten higher as circumvention information becomes harder to find and many solutions require at least some technical know-how. Through its {{< drawer title="DNS" >}}The system that converts a human-friendly domain name (e.g., “catvideos.com”) into a computer-friendly IP address (e.g., “157.240.22.35”). By converting domain names into IP addresses, DNS allows routers throughout the internet to efficiently send information to the correct destination. DNS relies on <b>DNS resolvers</b> and <b>nameservers</b> to assist with this conversion.{{< /drawer >}}, {{< drawer title="IP" >}}The set of rules, developed over time and with the input of many different international organizations and individuals, that guides how packets of data travel across networks and that allows the many different networks that make up the internet to be interoperable. Internet Protocol Version 4 (IPv4) and Internet Protocol Version 6 (IPv6) are both currently in use on the internet.{{< /drawer >}}, and {{< drawer title="HTTP" >}}A set of instructions for requesting information from a website (or other online resource), as well as sending and receiving that information. As such, it serves as the foundation for internet communication. HTTP functions at the <b>application layer</b> of the network stack.{{< /drawer >}} filtering systems, China long ago pre-empted basic circumvention methods that websites might themselves employ, like changing {{< drawer title="IP addresses" >}}Characters identifying computers or servers using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} or domain names. And easy-to-use encrypted apps like Signal aren’t available in-country thanks to restrictions placed on app stores.

Many of the remaining circumvention mechanisms rely on a simple premise: showing a false destination to the censor. The censor sees the false destination, thinks it’s ok, and lets the traffic through to the false destination. The false destination (like “aws.amazon.com”) then forwards on the internet traffic to the real destination. 

## The Rise and Fall of Domain Fronting

For a few years in the 2010s, a practice called **domain fronting** offered a censorship workaround to websites and apps (like [Telegram](https://archive.ph/cxt7x) and [Signal](https://archive.ph/Ba7IY)) otherwise banned in China. Domain fronting tweaks the standard settings when sending an {{< drawer title="HTTPS" >}}A secure version of HTTP, used by most modern websites in most countries, that determines how data is sent between a user and a website. At the application layer, the information is still formatted as HTTP.  HTTPS simply wraps this HTTP data in a layer of encryption before sending it out over the internet.{{< /drawer >}} message \[LINK\], making sure that a censor only sees a false destination (a **front**) and hides the real destination deeper inside the HTTPS encryption.

A standard {{< drawer title="HTTPS" >}}A secure version of HTTP, used by most modern websites in most countries, that determines how data is sent between a user and a website. At the application layer, the information is still formatted as HTTP.  HTTPS simply wraps this HTTP data in a layer of encryption before sending it out over the internet.{{< /drawer >}} connection requires several initial steps: first, a {{< drawer title="DNS lookup" >}}The process by which a user’s computer converts human-friendly domain names into computer-friendly IP addresses. It consists of the computer sending the domain name to a DNS resolver, which searches for and returns the corresponding IP address to the user.{{< /drawer >}} to turn the user-typed domain name into an {{< drawer title="IP address" >}}A series of characters that identifies a computer or server using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}}; second, a {{< drawer title="TCP handshake" >}}The mechanism <b>TCP</b> uses to establish a connection between two endpoints. The handshake ensures that each side of the connection is available and ready to transmit and receive data. The handshake works by both sides exchanging three different types of packets: first, a synchronization, or SYN, packet; second, a synchronize-acknowledge, or SYN-ACK, packet; and third, an acknowledgement, or ACK, packet.{{< /drawer >}} to make the initial connection between user and server \[LINK\]; and third, a {{< drawer title="TLS handshake" >}}A protocol used by HTTPS to conduct a second three-way handshake between two endpoints. During this handshake, the two sides of the connection exchange information that allows them to agree on an encryption key, which they then use to encrypt all subsequent traffic between them.{{< /drawer >}}, which includes sending the server name identification (SNI) \[LINK\]. Once the TLS handshake is complete, the user can send a regular {{< drawer title="HTTP" >}}A set of instructions for requesting information from a website (or other online resource), as well as sending and receiving that information. As such, it serves as the foundation for internet communication. HTTP functions at the <b>application layer</b> of the network stack.{{< /drawer >}} message, safely encrypted within the overall HTTPS (TLS) protocol. 

{{< drawer title="Domain fronting" >}}A censorship circumvention technique that sends internet packets to a false destination (a <b>front</b>) while hiding the real destination deeper within the packet structure. A censor would only see the front, usually a large website such as Amazon or Google, and allow the traffic to pass. This method, however, relies on the front websites unpacking the packets, seeing the true destination, and forwarding on the packets to the true destination—which many front websites have stopped doing.{{< /drawer >}} exploits the fact that a destination domain name appears in [three different places](https://www.bamsoftware.com/papers/fronting/) when establishing an {{< drawer title="HTTPS" >}}A secure version of HTTP, used by most modern websites in most countries, that determines how data is sent between a user and a website. At the application layer, the information is still formatted as HTTP.  HTTPS simply wraps this HTTP data in a layer of encryption before sending it out over the internet.{{< /drawer >}} connection: in the initial {{< drawer title="DNS lookup" >}}The process by which a user’s computer converts human-friendly domain names into computer-friendly IP addresses. It consists of the computer sending the domain name to a DNS resolver, which searches for and returns the corresponding IP address to the user.{{< /drawer >}}, in the SNI field, and in the {{< drawer title="HTTP" >}}A set of instructions for requesting information from a website (or other online resource), as well as sending and receiving that information. As such, it serves as the foundation for internet communication. HTTP functions at the <b>application layer</b> of the network stack.{{< /drawer >}} host header \[LINK\]. The former two are unencrypted, or cleartext. The HTTP host header, snug within the HTTPS (TLS) encryption, is not readable without decryption. So it is possible to list an uncensored front website in the {{< drawer title="DNS lookup" >}}The process by which a user’s computer converts human-friendly domain names into computer-friendly IP addresses. It consists of the computer sending the domain name to a DNS resolver, which searches for and returns the corresponding IP address to the user.{{< /drawer >}} and in the SNI field, with a censored target website in the HTTP host header, and not trigger any DNS or HTTPs filtering:

![Circumvention](/media/images/circumvention-1.png)

There are two keys to this technique working. First, the front websites have to actually forward the {{< drawer title="HTTP" >}}A set of instructions for requesting information from a website (or other online resource), as well as sending and receiving that information. As such, it serves as the foundation for internet communication. HTTP functions at the <b>application layer</b> of the network stack.{{< /drawer >}} request to the target destination—many websites will simply not forward traffic that isn’t actually directed to them. This is a reasonably easy barrier to overcome; even an individual with minimal technical knowledge could set up a {{< drawer title="server" >}}A computer that “serves up” requested content. Most online information is stored (or hosted) on a server. When a user visits a website, it is a server that actually sends back the website content to the user. Servers exist for many different purposes. Major social media companies have many of them in order to provide content to users quickly.{{< /drawer >}} outside China that would forward such traffic. Were someone to do this, however, it would also be reasonably easy for authorities to block that server’s {{< drawer title="IP address" >}}A series of characters that identifies a computer or server using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} and thereby stop the domain forwarding.

This is where the second key comes in: The front websites should be large and economically important enough that censors (in China, Russia, or anywhere else) would be hesitant to block them. Such websites might include major multinational sites like Amazon/AWS. The censors then have to choose between blocking the front website entirely—”blocking all”—or knowingly letting the unwanted traffic evade the system—”blocking none.” As a computer scientist [told](https://www.wsj.com/articles/u-s-cloud-providers-face-backlash-from-chinas-censors-1426541126) *The* *Wall Street Journal* in 2015, “The philosophy \[behind {{< drawer title="domain fronting" >}}A censorship circumvention technique that sends internet packets to a false destination (a <b>front</b>) while hiding the real destination deeper within the packet structure. A censor would only see the front, usually a large website such as Amazon or Google, and allow the traffic to pass. This method, however, relies on the front websites unpacking the packets, seeing the true destination, and forwarding on the packets to the true destination—which many front websites have stopped doing.{{< /drawer >}}\] is to make it as expensive to block as possible, so that there would be a lot of collateral damage.” 

For a number of years, companies that host large quantities of web traffic, such as Amazon/AWS, Google, and Microsoft/Azure, had servers that *would* forward such traffic as a default. For example, someone in China using a {{< drawer title="domain fronting" >}}A censorship circumvention technique that sends internet packets to a false destination (a <b>front</b>) while hiding the real destination deeper within the packet structure. A censor would only see the front, usually a large website such as Amazon or Google, and allow the traffic to pass. This method, however, relies on the front websites unpacking the packets, seeing the true destination, and forwarding on the packets to the true destination—which many front websites have stopped doing.{{< /drawer >}} tool might send their {{< drawer title="packets" >}}What the transport layer creates when preparing data to be sent from one computer to another. When the transport layer receives data from the application layer, it divides that data into segments called packets, which can then be individually processed and routed throughout the internet.{{< /drawer >}} to an AWS server. The AWS server would accept these packets, and upon unpacking them, realize they were actually meant for the encrypted messaging app Signal. The AWS server, ignoring the mismatch, would simply forward the traffic to Signal. These companies thus became important, if largely passive, players in the censorship circumvention ecosystem. Technologies that relied on domain fronting, like Telegram and Signal, benefited from the resulting [**collateral freedom**](https://en.wikipedia.org/wiki/Collateral_freedom).

The vulnerability in this technique, however, lies with the companies themselves. The companies don’t *have* to forward traffic not actually directed to them—they can choose to stop serving as fronts. [Over](https://archive.ph/FlaVp) the [last](https://archive.ph/v3JYW) [decade](https://archive.ph/PDjeI), that is exactly what happened. Some observers [credit](https://web.archive.org/web/20180503191229/https://www.bloomberg.com/view/articles/2018-05-03/telegram-block-gets-help-from-google-and-amazon) Russia (another major nation-state censor) with applying enough pressure to Google and Amazon specifically that they reconfigured their systems to disallow {{< drawer title="domain fronting" >}}A censorship circumvention technique that sends internet packets to a false destination (a <b>front</b>) while hiding the real destination deeper within the packet structure. A censor would only see the front, usually a large website such as Amazon or Google, and allow the traffic to pass. This method, however, relies on the front websites unpacking the packets, seeing the true destination, and forwarding on the packets to the true destination—which many front websites have stopped doing.{{< /drawer >}} in 2018. Now, domain fronting at scale is no longer the censorship solution it had been just a few years ago.

## Traffic Routing through Proxies

Many of the most popular mechanisms to evade censorship in China rely on proxy servers. Proxy servers, or proxies, are simply machines that serve as middlemen—they accept and forward on traffic that is ultimately meant for another server. They are the front that China’s censorship system sees instead of the real destination. Different organizations may set up their proxy networks in different ways, but they all fundamentally involve a user, a destination server, and at least one proxy server in between the two, relaying traffic between the user and the destination.

It works like this: Someone in China hoping to read *The* *New York Times* (whose website is banned in China) may try to use a proxy server to connect. Using the proxy software of their choice, they would type in “www.nytimes.com.” Instead of doing a {{< drawer title="DNS lookup" >}}The process by which a user’s computer converts human-friendly domain names into computer-friendly IP addresses. It consists of the computer sending the domain name to a DNS resolver, which searches for and returns the corresponding IP address to the user.{{< /drawer >}} right there from the computer in China, the proxy software would send this request to a proxy server in another location—so all the {{< drawer title="packets" >}}What the transport layer creates when preparing data to be sent from one computer to another. When the transport layer receives data from the application layer, it divides that data into segments called packets, which can then be individually processed and routed throughout the internet.{{< /drawer >}} sent from the user to the proxy server would have the proxy server’s {{< drawer title="IP address" >}}A series of characters that identifies a computer or server using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} on them. A Chinese government {{< drawer title="middlebox" >}}A machine that is positioned between two endpoints of online communications, often in order to read the contents of those communications as they pass back and forth.{{< /drawer >}} inspecting the packets would only see an innocuous IP address totally unrelated to *The* *New York Times*. Once the packets reached the proxy server, the proxy server would initiate the {{< drawer title="DNS lookup" >}}The process by which a user’s computer converts human-friendly domain names into computer-friendly IP addresses. It consists of the computer sending the domain name to a DNS resolver, which searches for and returns the corresponding IP address to the user.{{< /drawer >}} and fetch *The* *New York Times* homepage. Finally, the proxy server would send *The* *New York Times* homepage information back to the user—again, with all the packets appearing to come from the proxy server, not from *The* *New York Times*. 

This system works as long as the Chinese authorities do not realize that the proxy server is, in fact, the proxy server. Once they recognize the proxy server for what it is, they can easily add the proxy server’s IP address to a blocklist. 

![Circumvention](/media/images/circumvention-2.png)

There are several different models a proxy provider might use to set up a proxy network and provide service to customers. Many companies offer virtual private network (VPN) services, which [function](https://mullvad.net/en/vpn/what-is-vpn) almost exactly as described above. (Indeed, many people use the terms “VPN” and “proxy” interchangeably to refer to technologies that help evade censorship, a convention which we follow in this article.) These companies maintain the various proxy servers specifically set up to handle users’ traffic and usually route a user’s traffic through a single proxy per session. The Onion Router, software more commonly known as Tor, works in a similar way, though as a free service it depends on volunteers to run its proxy servers. It also shepherds traffic through [at least three different proxy servers](https://support.torproject.org/about/how-is-tor-different-from-other-proxies/) each time traffic moves from one endpoint to another, making it extremely difficult for a censor to discover the ultimate destination of the traffic—or, for that matter, for any of the proxy servers in the network to have information about both endpoints in the connection. Shadowsocks, a piece of software created by a Chinese programmer who later dropped out of the project under [pressure from the police](https://chinadigitaltimes.net/2015/08/circumvention-tool-deleted-after-police-visit-developer/), uses a slightly different technical mechanism to connect to proxies, and it allows users to choose those proxies either by [paying a VPN company for access](https://mullvad.net/en/help/intro-shadowsocks) or by [remotely setting up their own servers](https://shadowsocks.org/doc/deploying.html) outside China. Whatever the exact mechanism, a proxy provider is basically just helping a user access one or more servers that can help disguise the ultimate destination of the user’s traffic.

![Circumvention](/media/images/circumvention-3.png)

## The Traffic Routing Arms Race

Though traffic routing does often successfully obscure a user’s browsing habits, it suffers from several key vulnerabilities. For one, it often relies on users’ discovery of information—information about how to install software, or the most recent list of functioning {{< drawer title="proxy servers" >}}Machines that are set up to accept and forward on traffic that is ultimately meant for another server. Also known simply as “proxies,” proxy servers obscure a user’s true destination, with a censor only able to see the proxy server’s IP address and not the IP address of the true destination. In common parlance, the terms “proxy” and “VPN” are used interchangeably to describe a technology that helps evade censorship.{{< /drawer >}}. Censors can target and block just this sort of information. For another, a motivated censor can block the {{< drawer title="IP addresses" >}}Characters identifying computers or servers using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} of proxy servers just as well as it can block the IP addresses of “dangerous” websites themselves (more on that below). Circumvention tool developers and Beijing have been engaged in a silent battle on both of these fronts.

For over a decade, the Chinese censorship system has actively tried to discover proxy servers and prevent China-based users from connecting to them. (These efforts complement other non-technical means to prevent internet users in China from accessing proxies, such as [forcing Apple](https://www.ft.com/content/ad42e536-cf36-11e7-b781-794ce08b24dc) on multiple occasions over the past decade to remove circumvention tools from its app store in China.) The following sections catalog Beijing’s shifting tactics over time, as circumvention providers worked to overcome previous blocks.

### Blocking Proxies Based on Public Information

In 2009, just as the People’s Republic of China was preparing to celebrate the 60th anniversary of its founding, the censorship system took aim at Tor’s network of {{< drawer title="proxy servers" >}}Machines that are set up to accept and forward on traffic that is ultimately meant for another server. Also known simply as “proxies,” proxy servers obscure a user’s true destination, with a censor only able to see the proxy server’s IP address and not the IP address of the true destination. In common parlance, the terms “proxy” and “VPN” are used interchangeably to describe a technology that helps evade censorship.{{< /drawer >}}. At the time, this was a fairly straightforward task: Tor maintained a publicly-available list of proxy servers, and censors simply [blocked](https://blog.torproject.org/tor-partially-blocked-china/) the listed proxies’ {{< drawer title="IP addresses" >}}Characters identifying computers or servers using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}}. Tor then began distributing new proxy addresses via email. The following year, China’s censors learned the IP addresses of those proxies and [blocked them as well](https://youtu.be/ZB8ODpw_om8?si=hcoSLVVrwYjWHHII&t=864). This left Tor dependent on individuals’ sharing proxy addresses directly with others in their social networks—a serious degradation in users’ discovery of circumvention information. By 2015, China’s censors were downloading and [running](https://www.usenix.org/system/files/conference/foci16/foci16-paper-fifield.pdf) Tor’s software to find and block proxies within a month of each new software release. And in 2016, the censors didn’t even wait for the software release. Once Tor posted the source code publicly, even before the software’s official release, censors began [inspecting](https://www.bamsoftware.com/papers/thesis/#sec:china-preemptive) the code and blocking the proxies listed there before anyone in China had a chance to use them.

### Blocking Proxies Based on Fingerprinting and Active Probing

Not all proxy {{< drawer title="IP addresses" >}}Characters identifying computers or servers using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} are openly available online, however. China’s censorship system therefore actively works to discover additional unknown {{< drawer title="proxy servers" >}}Machines that are set up to accept and forward on traffic that is ultimately meant for another server. Also known simply as “proxies,” proxy servers obscure a user’s true destination, with a censor only able to see the proxy server’s IP address and not the IP address of the true destination. In common parlance, the terms “proxy” and “VPN” are used interchangeably to describe a technology that helps evade censorship.{{< /drawer >}} in order to prevent internet users within the country from accessing them. Since [at least 2011](https://blog.torproject.org/knock-knock-knockin-bridges-doors/), Chinese censors have employed a two-step process to detect and confirm the identity of proxy servers in order to disrupt their services. This process is on the lookout for [multiple different circumvention](https://ensa.fi/active-probing/imc2015.pdf) protocols, including but not limited to Tor and Shadowsocks. The two-step process works like this:

1) **Fingerprinting traffic.** When a user in China connects (or attempts to connect) to a proxy server, the back-and-forth exchange of information during or just after a TCP or TLS handshake can provide a censor with valuable information about the nature of the connection, encryption notwithstanding. A censor monitoring the type or format of the information exchanged can determine whether or not circumvention technology is being used, and, if so, proceed to step 2\.  
     
   For example, Shadowsocks software “attempts to avoid detection . . . by using encryption to appear as a [uniformly random byte stream](https://censorbib.nymity.ch/pdf/Alice2020a.pdf).” Essentially, Shadowsocks tries to hide in plain sight by appearing to the censor as a truly random string of characters. However, even this “randomness” can serve as a tip-off to a censor—it’s simply *too* random to be a normal, unencrypted {{< drawer title="packet" >}}What the transport layer creates when preparing data to be sent from one computer to another. When the transport layer receives data from the application layer, it divides that data into segments called packets, which can then be individually processed and routed throughout the internet.{{< /drawer >}}. In addition, when Shadowsocks creates {{< drawer title="TCP" >}}A standard for delivering data online, specifying how to break data up into packets in preparation to be transmitted over the internet. Because TCP ensures that each side of a connection is ready before transmitting data, and because it allows for data reassembly at the destination, TCP is most often used by applications prioritizing reliability and completeness, such as web browsing, email, and file transfers.{{< /drawer >}} packets, the packets tend to have a certain length, give or take some characters. [Since May 2019](https://censorbib.nymity.ch/pdf/Alice2020a.pdf), China’s censorship system has used these two facts to detect and block Shadowsocks traffic. After the initial {{< drawer title="TCP handshake" >}}The mechanism <b>TCP</b> uses to establish a connection between two endpoints. The handshake ensures that each side of the connection is available and ready to transmit and receive data. The handshake works by both sides exchanging three different types of packets: first, a synchronization, or SYN, packet; second, a synchronize-acknowledge, or SYN-ACK, packet; and third, an acknowledgement, or ACK, packet.{{< /drawer >}}, the censor inspects the first data packet the user sends to the proxy server; if that packet has a high level of “entropy” (randomness) *and* is of a certain length, the censor determines that the traffic was likely generated by Shadowsocks, and proceeds to step 2\. (The principle of fingerprinting also works against very common protocols, [like](https://censorbib.nymity.ch/#Frolov2019a) [TLS](https://github.com/net4people/bbs/issues/54).)

2) **Active probing of suspected proxy servers**. Through step 1, China’s censorship system identifies potential proxy servers, learning both the proxy’s {{< drawer title="IP address" >}}A series of characters that identifies a computer or server using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} and the type of circumvention tool it supports. With this information, the system is able to send probes to the proxy server. A probe is simply an attempt to connect to the suspected proxy server. The probe [pretends](https://blog.torproject.org/knock-knock-knockin-bridges-doors/) to be [legitimate traffic](https://ensa.fi/active-probing/imc2015.pdf) from a [circumvention user](https://censorbib.nymity.ch/pdf/Alice2020a.pdf)—sometimes it even mimics the exact data packet that caused the system to send the probe in the first place, which is known as a replay attack. The censorship system usually sends multiple probes to the proxy server. The pace at which the probes are sent can vary [over time](https://blog.torproject.org/knock-knock-knockin-bridges-doors/) and by circumvention tool (some being sent [days or even weeks](https://censorbib.nymity.ch/pdf/Alice2020a.pdf) after the system flagged the proxy server in step 1). But Beijing appears to have invested in this technology over the last decade or so, as sometime in the mid-2010s the probing system began to send out some probes [less than a second](https://ensa.fi/active-probing/imc2015.pdf) after completing step 1—a speed it had previously been incapable of managing.  
   
Once the system confirms that the server is indeed a proxy server, it may block that server by {{< drawer title="IP address" >}}A series of characters that identifies a computer or server using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}}—though depending on the circumvention tool, it may not impose a block every time. (Researchers working on Shadowsocks blocking in 2020 [reported](https://censorbib.nymity.ch/pdf/Alice2020a.pdf) that only 3 of their 63 test proxy servers got blocked, even though many of them had received a flurry of probes. They couldn’t be sure why more proxies weren’t blocked, but speculated that either the decision to block is made by a human rather than automated, or that some versions of Shadowsocks they were testing were more resistant to active probing.) Once imposed, a block is [usually temporary](https://censorbib.nymity.ch/pdf/Alice2020a.pdf), lasting from 12 hours to several weeks, likely because many proxy providers frequently swap out proxies and IP addresses and retaining a block long-term could cause too much collateral economic and reputational damage. 

China’s probes come from a wide range of IP addresses that change frequently. This means that circumvention providers can’t simply keep a list of the probes’ IP addresses and configure their proxy servers to [ignore](https://censorbib.nymity.ch/pdf/Alice2020a.pdf) them—there are simply too many IP addresses to keep track of, and there is a decent chance that a legitimate user might eventually be assigned one of them. 

In November 2021, censors implemented a second proxy-blocking mechanism that works in parallel with the two-step method described above, aimed at a variety of circumvention protocols and likely designed to catch any traffic that the two-step method might miss. This mechanism wasn’t entirely new—it was more like the repurposing of an older technique, aimed at a new target (proxy traffic). Because China has such a depth of expertise on internet censorship, it often doesn’t need to create new mechanisms out of whole cloth; it can simply dig around in its existing toolbox and modify an existing tool to get the job done. (Notably, censors had [stopped](https://youtu.be/WCRxbmacQg0?si=jG6V2xnu-SyKmeuy&t=630) using this blocking mechanism by March 2023, for reasons unknown. Still, as it represented a significant development in China’s anti-circumvention efforts, and because it demonstrates that the censors continue to rely on relatively low-tech methods to block traffic, it is worth describing here.)

The “new” mechanism employed only the first of the previous two steps: {{< drawer title="fingerprinting" >}}A method for detecting certain types of encrypted internet traffic. In China, fingerprinting is often used to detect internet traffic that is attempting to evade network-level censorship. Because encryption prevents a censor from viewing the content of a packet, fingerprinting techniques allow the censor to instead analyze the visible parts of the packet; if the visible parts of the packet conform to certain specific patterns (“fingerprints”) associated with particular circumvention tools, the censor can block the packet.{{< /drawer >}} (detecting encrypted internet traffic by comparing the visible parts of the {{< drawer title="packet" >}}What the transport layer creates when preparing data to be sent from one computer to another. When the transport layer receives data from the application layer, it divides that data into segments called packets, which can then be individually processed and routed throughout the internet.{{< /drawer >}} against a set of known patterns associated with circumvention tools). It then blocked traffic without any active probing follow-up. Researchers describing this new system [hypothesized](https://gfw.report/publications/usenixsecurity23/en/) that it was, at least in part, a reaction to circumvention providers’ efforts to make their proxy servers more resistant to active probing—another escalation in the ongoing arms race. 

Just like the {{< drawer title="fingerprinting" >}}A method for detecting certain types of encrypted internet traffic. In China, fingerprinting is often used to detect internet traffic that is attempting to evade network-level censorship. Because encryption prevents a censor from viewing the content of a packet, fingerprinting techniques allow the censor to instead analyze the visible parts of the packet; if the visible parts of the packet conform to certain specific patterns (“fingerprints”) associated with particular circumvention tools, the censor can block the packet.{{< /drawer >}} described above, the new mechanism aimed to detect and block encrypted traffic that seemed bound for proxy servers, using what researchers described as “[crude but efficient heuristics](https://gfw.report/publications/usenixsecurity23/en/)” to identify such traffic. Notably, the mechanism seemed to monitor only a limited number of connections and block only a portion of encrypted traffic. Researchers speculated the mechanism limited itself in this way “[to mitigate false positives and reduce operation costs](https://gfw.report/publications/usenixsecurity23/en/).” Observing the mechanism’s behavior and working backwards to infer general rules guiding its actions, researchers posited that:

1) The mechanism monitored connections only to {{< drawer title="IP addresses" >}}Characters identifying computers or servers using the IP system to communicate over the internet. Internet Protocol Version 4 (IPv4) addresses are composed of a set of four numbers, each with one to three digits, separated by periods (for example, <b>104.18.204.43</b>). Internet Protocol Version 6 (IPv6) addresses are longer and can also include letters (such as <b>1050:0:0:0:5:600:300c:326b</b>).{{< /drawer >}} associated with popular data centers (i.e., those most likely to host proxy servers).   
2) Within these select connections, it inspected only the first data packet sent after a {{< drawer title="TCP handshake" >}}The mechanism <b>TCP</b> uses to establish a connection between two endpoints. The handshake ensures that each side of the connection is available and ready to transmit and receive data. The handshake works by both sides exchanging three different types of packets: first, a synchronization, or SYN, packet; second, a synchronize-acknowledge, or SYN-ACK, packet; and third, an acknowledgement, or ACK, packet.{{< /drawer >}} (the mechanism inspects only {{< drawer title="TCP" >}}A standard for delivering data online, specifying how to break data up into packets in preparation to be transmitted over the internet. Because TCP ensures that each side of a connection is ready before transmitting data, and because it allows for data reassembly at the destination, TCP is most often used by applications prioritizing reliability and completeness, such as web browsing, email, and file transfers.{{< /drawer >}}, not UDP, packets).  
3) It determined whether the packet:  
   1) Had too high an entropy (appeared “too random,” meaning it was likely encrypted traffic designed to appear random).  
   2) Contained too few human-readable characters, or not enough human-readable characters, in particular locations within the packet.  
   3) Did not match popular internet protocols like {{< drawer title="HTTP" >}}A set of instructions for requesting information from a website (or other online resource), as well as sending and receiving that information. As such, it serves as the foundation for internet communication. HTTP functions at the <b>application layer</b> of the network stack.{{< /drawer >}} and {{< drawer title="TLS" >}}A protocol used by HTTPS to conduct a second three-way handshake between two endpoints. During this handshake, the two sides of the connection exchange information that allows them to agree on an encryption key, which they then use to encrypt all subsequent traffic between them.{{< /drawer >}}.  
4) If any of the conditions from \#3 were met, the mechanism blocked roughly one out of every four instances. Blocking consisted of:  
   1) Dropping packets sent from the user to the proxy server. Dropping packets, rather than initiating a {{< drawer title="TCP reset" >}}A type of packet, and also the name of a mechanism frequently deployed by the Chinese censorship system to forcibly disrupt specific internet connections. After detecting undesirable content, a path-adjacent <b>middlebox</b> issues one or more TCP reset packets to each end of the connection. These packets instruct each endpoint of the connection to reset itself, effectively terminating the connection. This mechanism does not technically <em>block</em> content that has already been sent; instead, it tricks the endpoints into breaking the connection so no more content is sent or received. Also known as TCP RST.{{< /drawer >}}
, indicated the mechanism used relatively expensive, resource-intensive {{< drawer title="in-path" >}}A middlebox that sits directly on a cable transferring information between two endpoints. All internet traffic therefore also transits the middlebox before reaching its intended destination. An in-path middlebox can opt to block certain pieces of unwanted internet traffic so that they never reach their intended destination (also known as <b>dropping</b> traffic).{{< /drawer >}} middleboxes\[LINK\]).  
   2) Enforcing {{< drawer title="residual censorship" >}}he period during which, after censors have forcibly disrupted an internet connection between two endpoints, all further connections between those two endpoints are blocked. Chinese authorities enforce residual censorship to punish users who attempt to view banned content, or simply to make users think that the website in question is unstable and not worth visiting. Residual censorship can last anywhere from a few seconds to multiple hours.{{< /drawer >}} for two-three minutes. 

Nearly a year after this method was implemented, in October 2022, researchers noted that another {{< drawer title="fingerprinting" >}}A method for detecting certain types of encrypted internet traffic. In China, fingerprinting is often used to detect internet traffic that is attempting to evade network-level censorship. Because encryption prevents a censor from viewing the content of a packet, fingerprinting techniques allow the censor to instead analyze the visible parts of the packet; if the visible parts of the packet conform to certain specific patterns (“fingerprints”) associated with particular circumvention tools, the censor can block the packet.{{< /drawer >}} mechanism had been [levied against an even wider array of circumvention tools](https://github.com/net4people/bbs/issues/129), though no one has yet explained the exact method of fingerprinting method used.